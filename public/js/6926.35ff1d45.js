"use strict";(self["webpackChunk_coreui_coreui_free_vue_admin_template"]=self["webpackChunk_coreui_coreui_free_vue_admin_template"]||[]).push([[6926],{6926:function(a,t,e){e.r(t),e.d(t,{default:function(){return oa}});e(7658);var l=e(3396),o=e(9242);const s={class:"card"},n={class:"card-header"},i={key:0,class:"mb-4"},r={key:1,class:"mb-4"},d={class:"card-body"},u={class:"row"},g={class:"form-group col-12 col-md-6 pt-2"},c=(0,l._)("label",{for:"nombre",class:"form-label"},"Nombre",-1),p={class:"form-group col-12 col-md-6 pt-2"},m=(0,l._)("label",{for:"subtitle",class:"form-label"},"Subtítulo",-1),b={class:"form-group col-12 pt-2"},f=(0,l._)("label",{for:"slug",class:"form-label"},"Url amigable",-1),_={class:"input-group mb-3"},h=["href"],v=(0,l._)("i",{class:"fas fa-external-link me-2"},null,-1),x={class:"form-group col-12 col-md-6 pt-2"},y={class:"mb-3"},T=(0,l._)("span",null,"Configurar acceso por distribuidores",-1),w={class:"form-group col-12 col-md-6 pt-2"},Z={class:"mb-3"},k=(0,l._)("span",null,"Visibilidad de página",-1),V=(0,l._)("option",{value:"0"},"Privada",-1),U=(0,l._)("option",{value:"1"},"Pública",-1),C=[V,U],O={class:"form-group col-12 mt-2"},j=(0,l._)("label",{for:"img",class:"form-label"},"Imagen destacada",-1),I={class:"row"},E={class:"col-12 col-md-6 pt-2"},z={key:0,class:"col-12 col-md-4 pt-2 text-center"},P=["src"],S={class:"form-group col-12 col-md-12 pt-2"},q=(0,l._)("label",{for:"Tags",class:"form-label"},"Tags",-1),A={class:"form-group col-12 col-md-12 pt-2"},D=(0,l._)("label",{for:"contenido",class:"form-label"},"Contenido",-1),F={class:"form-group col-12 col-md-12 pt-2"},G=(0,l._)("label",{for:"extracto",class:"form-label"},"Extracto",-1),B={class:"card-footer text-end"};function W(a,t,e,V,U,W){const $=(0,l.up)("multiselect"),M=(0,l.up)("file-pond"),L=(0,l.up)("vue3-tags-input"),N=(0,l.up)("editor");return(0,l.wg)(),(0,l.iD)("div",s,[(0,l._)("div",n,[0===U.page.id?((0,l.wg)(),(0,l.iD)("h2",i,"Crear nota")):(0,l.kq)("",!0),0!==U.page.id?((0,l.wg)(),(0,l.iD)("h2",r,"Editando nota")):(0,l.kq)("",!0)]),(0,l._)("div",d,[(0,l._)("div",u,[(0,l._)("div",g,[c,(0,l.wy)((0,l._)("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>U.page.nombre=a),type:"text",class:"form-control",id:"nombre"},null,512),[[o.nr,U.page.nombre]])]),(0,l._)("div",p,[m,(0,l.wy)((0,l._)("input",{"onUpdate:modelValue":t[1]||(t[1]=a=>U.page.subtitle=a),type:"text",class:"form-control",id:"subtitle"},null,512),[[o.nr,U.page.subtitle]])]),(0,l._)("div",b,[f,(0,l._)("div",_,[(0,l.wy)((0,l._)("input",{"onUpdate:modelValue":t[2]||(t[2]=a=>U.page.slug=a),type:"text",class:"form-control",id:"slug"},null,512),[[o.nr,U.page.slug]]),(0,l._)("a",{href:"#/blog/"+U.page.slug,class:"btn btn-primary",target:"_blank"},[v,(0,l.Uk)("Ver nota")],8,h)])]),(0,l._)("div",x,[(0,l._)("div",y,[T,(0,l.Wm)($,{modelValue:U.page.grupos_assign,"onUpdate:modelValue":t[3]||(t[3]=a=>U.page.grupos_assign=a),options:U.page.grupos,mode:"tags",searchable:!0},null,8,["modelValue","options"])])]),(0,l._)("div",w,[(0,l._)("div",Z,[k,(0,l.wy)((0,l._)("select",{class:"form-select","onUpdate:modelValue":t[4]||(t[4]=a=>U.page.publica=a)},C,512),[[o.bM,U.page.publica]])])]),(0,l._)("div",O,[j,(0,l._)("div",I,[(0,l._)("div",E,[(0,l.Wm)(M,{type:"file",class:"filepond",name:"img","label-idle":"Puedes arrastrar tu imagen aquí",credits:"false","allow-file-size-validation":"true","max-file-size":"3MB",ref:"filepondInput",server:{process:(a,t,e,l,o,s,n)=>{W.handleFileUpload(a,t,e,l,o,s,n,U.page)}}},null,8,["server"])]),U.page.img?((0,l.wg)(),(0,l.iD)("div",z,[(0,l._)("img",{src:U.page.img,class:"img img-thumbnail",style:{"max-width":"150px"}},null,8,P)])):(0,l.kq)("",!0)]),(0,l._)("div",S,[q,(0,l.Wm)(L,{tags:U.page.Options,placeholder:"Ingresa palabras clave",class:"form-control",onOnTagsChanged:W.addTag},null,8,["tags","onOnTagsChanged"])])]),(0,l._)("div",A,[D,(0,l.Wm)(N,{init:{plugins:U.plugins,toolbar:U.toolbar,language:U.language,promotion:!1,branding:!1},modelValue:U.page.contenido,"onUpdate:modelValue":t[5]||(t[5]=a=>U.page.contenido=a),"tinymce-script-src":"https://tinyroble.s3.amazonaws.com/tinymce/tinymce.min.js"},null,8,["init","modelValue"])]),(0,l._)("div",F,[G,(0,l.wy)((0,l._)("textarea",{"onUpdate:modelValue":t[6]||(t[6]=a=>U.page.extracto=a),class:"form-control",id:"extracto"},null,512),[[o.nr,U.page.extracto]])])])]),(0,l._)("div",B,[(0,l._)("button",{onClick:t[7]||(t[7]=t=>a.$router.push("/admin/blog/list")),class:"btn btn-danger me-2"},"Cancelar"),(0,l._)("button",{type:"button",onClick:t[8]||(t[8]=(...a)=>W.guardarBlog&&W.guardarBlog(...a)),class:"btn btn-primary"},"Guardar")])])}var $=e(5046),M=e(7091),L=e(3453),N=e(7014),H=e.n(N),J=(e(9657),e(3339)),K=e.n(J),Q=e(2548),R=e.n(Q),X=(e(4973),e(4768)),Y=e(7758);const aa=H()(K(),R());var ta={components:{Select:Y.Z,Multiselect:M.Z,Editor:$.Z,Vue3TagsInput:L.Z,FilePond:aa},data(){return{page:{id:0,nombre:"",slug:"",extracto:"",contenido:"",status:1,subtitle:"",img:"",Tags:"",Options:[],publica:0,grupos:[],grupos_assign:[]},plugins:"code autoresize autosave link image",toolbar:"undo redo | fontsizeselect formatselect | bold italic forecolor | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent blockquote | link image media",language:"es",editor:null}},watch:{"page.nombre":function(a){this.page.slug=this.createSlug(a)}},mounted(){this.page.id="undefined"!==typeof this.$route.params.id?parseInt(this.$route.params.id):0,this.getGrupos()},methods:{addTag(a){this.page.Options=a,this.page.Tags=a.toString()},handleFileUpload(a,t,e,l,o,s,n,i){const r=new FormData;for(const u in i)"img"!==u&&r.append(u,i[u]);r.append(a,t,t.name);const d=0!==this.page.id?"paginas/new/edit/"+this.page.id:"paginas/new/edit";return X.Z.doAjax("FILE",d,r,(function(a){a.status?(null!==a.data.id&&(i.id=a.data.id),null!==a.data.nombre&&(i.nombre=a.data.nombre),null!==a.data.slug&&(i.slug=a.data.slug),null!==a.data.extracto&&(i.extracto=a.data.extracto),null!==a.data.contenido&&(i.contenido=a.data.contenido),null!==a.data.status&&(i.status=a.data.status),null!==a.data.img&&(i.img=a.data.img),null!==a.data.subtitle&&(i.subtitle=a.data.subtitle),null!==a.data.Tags&&"null"!==a.data.Tags&&(console.log(a.data.Tags),i.Tags=a.data.Tags,i.Options=i.Tags.split(",")),X.Z.alert(a.msg),l(a.msg)):X.Z.alert(a.msg)}),(function(a){X.Z.alert(a.msg)})),{abort:()=>{n()}}},getItem(){const a=this;X.Z.doAjax("GET","paginas/by/"+a.page.id,{},(function(t){null!==t.data.id&&(a.page.id=t.data.id),null!==t.data.nombre&&(a.page.nombre=t.data.nombre),null!==t.data.slug&&(a.page.slug=t.data.slug),null!==t.data.extracto&&(a.page.extracto=t.data.extracto),null!==t.data.contenido&&(a.page.contenido=t.data.contenido),null!==t.data.status&&(a.page.status=t.data.status),null!==t.data.img&&(a.page.img=t.data.img),null!==t.data.subtitle&&(a.page.subtitle=t.data.subtitle),null!==t.data.subtitle&&(a.page.publica=t.data.publica),null!==t.data.Tags&&"null"!==t.data.Tags&&(a.page.Tags=t.data.Tags,a.page.Options=a.page.Tags.split(",")),null!==t.data.acc&&"null"!==t.data.acc&&(a.page.grupos_assign=[],Object.keys(t.data.acc).map((function(e,l){a.page.grupos_assign.push(t.data.acc[e])}))),X.Z.alert(t.msg)}),(function(a){X.Z.alert(a.msg,"danger")}))},guardarBlog(){const a=this;0===a.page.id?X.Z.confirm("Esta noticia se publicará automáticamente en el apartado de blog del sitio",(function(){X.Z.doAjax("POST","paginas/new/edit",a.page,(function(t){"undefined"!==typeof t.data.id&&a.$router.push("/admin/blog/editar/"+t.data.id),setTimeout((function(){location.reload()}),500),X.Z.alert(t.msg)}),(function(a){X.Z.alert(a.msg)}))})):X.Z.doAjax("PUT","paginas/editar/"+a.page.id,a.page,(function(a){X.Z.alert(a.msg)}),(function(a){X.Z.alert(a.msg)}))},createSlug(a){return a.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,"")},getGrupos(){const a=this;X.Z.doAjax("GET","users/grupo/list",{},(function(t){a.page.grupos=[],Object.keys(t.data).map((function(e,l){a.page.grupos.push({value:t.data[e].id,label:t.data[e].nombre})})),a.page.id>0&&a.getItem()}),(function(a){X.Z.alert(a.msg,"danger")}))}}},ea=e(89);const la=(0,ea.Z)(ta,[["render",W]]);var oa=la}}]);
//# sourceMappingURL=6926.35ff1d45.js.map