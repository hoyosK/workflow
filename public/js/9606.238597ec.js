"use strict";(self["webpackChunk_coreui_coreui_free_vue_admin_template"]=self["webpackChunk_coreui_coreui_free_vue_admin_template"]||[]).push([[9606],{9606:function(a,e,t){t.r(e),t.d(e,{default:function(){return oa}});t(7658);var l=t(3396),o=t(9242);const s={class:"card"},n={class:"card-header"},i={key:0,class:"mb-4"},r={key:1,class:"mb-4"},d={class:"card-body"},u={class:"row"},g={class:"form-group col-12 col-md-6 pt-2"},c=(0,l._)("label",{for:"nombre",class:"form-label"},"Nombre",-1),p={class:"form-group col-12 col-md-6 pt-2"},m=(0,l._)("label",{for:"subtitle",class:"form-label"},"Subtítulo",-1),b={class:"form-group col-12 pt-2"},f=(0,l._)("label",{for:"slug",class:"form-label"},"Url amigable",-1),_={class:"input-group mb-3"},h=["href"],v=(0,l._)("i",{class:"fas fa-external-link me-2"},null,-1),x={class:"form-group col-12 col-md-6 pt-2"},y={class:"mb-3"},T=(0,l._)("span",null,"Configurar acceso por distribuidores",-1),w={class:"form-group col-12 col-md-6 pt-2"},Z={class:"mb-3"},k=(0,l._)("span",null,"Visibilidad de página",-1),V=(0,l._)("option",{value:"0"},"Privada",-1),U=(0,l._)("option",{value:"1"},"Pública",-1),C=[V,U],O={class:"form-group col-12 mt-2"},j=(0,l._)("label",{for:"img",class:"form-label"},"Imagen destacada",-1),E={class:"row"},I={class:"col-12 col-md-6 pt-2"},z={key:0,class:"col-12 col-md-4 pt-2 text-center"},P=["src"],S={class:"form-group col-12 col-md-12 pt-2"},q=(0,l._)("label",{for:"Tags",class:"form-label"},"Tags",-1),A={class:"form-group col-12 col-md-12 pt-2"},D=(0,l._)("label",{for:"contenido",class:"form-label"},"Contenido",-1),F={class:"form-group col-12 col-md-12 pt-2"},G=(0,l._)("label",{for:"extracto",class:"form-label"},"Extracto",-1),B={class:"card-footer text-end"};function W(a,e,t,V,U,W){const $=(0,l.up)("multiselect"),M=(0,l.up)("file-pond"),L=(0,l.up)("vue3-tags-input"),N=(0,l.up)("Editor");return(0,l.wg)(),(0,l.iD)("div",s,[(0,l._)("div",n,[0===U.page.id?((0,l.wg)(),(0,l.iD)("h2",i,"Crear nota")):(0,l.kq)("",!0),0!==U.page.id?((0,l.wg)(),(0,l.iD)("h2",r,"Editando página de promociones")):(0,l.kq)("",!0)]),(0,l._)("div",d,[(0,l._)("div",u,[(0,l._)("div",g,[c,(0,l.wy)((0,l._)("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>U.page.nombre=a),type:"text",class:"form-control",id:"nombre"},null,512),[[o.nr,U.page.nombre]])]),(0,l._)("div",p,[m,(0,l.wy)((0,l._)("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>U.page.subtitle=a),type:"text",class:"form-control",id:"subtitle"},null,512),[[o.nr,U.page.subtitle]])]),(0,l._)("div",b,[f,(0,l._)("div",_,[(0,l.wy)((0,l._)("input",{"onUpdate:modelValue":e[2]||(e[2]=a=>U.page.slug=a),type:"text",class:"form-control",id:"slug"},null,512),[[o.nr,U.page.slug]]),(0,l._)("a",{href:"#/promociones/"+U.page.slug,class:"btn btn-primary",target:"_blank"},[v,(0,l.Uk)("Ver nota")],8,h)])]),(0,l._)("div",x,[(0,l._)("div",y,[T,(0,l.Wm)($,{modelValue:U.page.grupos_assign,"onUpdate:modelValue":e[3]||(e[3]=a=>U.page.grupos_assign=a),options:U.page.grupos,mode:"tags",searchable:!0},null,8,["modelValue","options"])])]),(0,l._)("div",w,[(0,l._)("div",Z,[k,(0,l.wy)((0,l._)("select",{class:"form-select","onUpdate:modelValue":e[4]||(e[4]=a=>U.page.publica=a)},C,512),[[o.bM,U.page.publica]])])]),(0,l._)("div",O,[j,(0,l._)("div",E,[(0,l._)("div",I,[(0,l.Wm)(M,{type:"file",class:"filepond",name:"img","label-idle":"Puedes arrastrar tu imagen aquí",credits:"false","allow-file-size-validation":"true","max-file-size":"3MB",ref:"filepondInput",server:{process:(a,e,t,l,o,s,n)=>{W.handleFileUpload(a,e,t,l,o,s,n,U.page)}}},null,8,["server"])]),U.page.img?((0,l.wg)(),(0,l.iD)("div",z,[(0,l._)("img",{src:U.page.img,class:"img img-thumbnail",style:{"max-width":"150px"}},null,8,P)])):(0,l.kq)("",!0)]),(0,l._)("div",S,[q,(0,l.Wm)(L,{tags:U.page.Options,placeholder:"Ingresa palabras clave",class:"form-control",onOnTagsChanged:W.addTag},null,8,["tags","onOnTagsChanged"])])]),(0,l._)("div",A,[D,(0,l.Wm)(N,{init:{plugins:U.plugins,toolbar:U.toolbar,language:U.language,promotion:!1,branding:!1},modelValue:U.page.contenido,"onUpdate:modelValue":e[5]||(e[5]=a=>U.page.contenido=a),"tinymce-script-src":"https://tinyroble.s3.amazonaws.com/tinymce/tinymce.min.js"},null,8,["init","modelValue"])]),(0,l._)("div",F,[G,(0,l.wy)((0,l._)("textarea",{"onUpdate:modelValue":e[6]||(e[6]=a=>U.page.extracto=a),class:"form-control",id:"extracto"},null,512),[[o.nr,U.page.extracto]])])])]),(0,l._)("div",B,[(0,l._)("button",{onClick:e[7]||(e[7]=e=>a.$router.push("/admin/promociones/list")),class:"btn btn-danger me-2"},"Cancelar"),(0,l._)("button",{type:"button",onClick:e[8]||(e[8]=(...a)=>W.guardarBlog&&W.guardarBlog(...a)),class:"btn btn-primary"},"Guardar")])])}var $=t(5046),M=t(7091),L=t(3453),N=t(7014),H=t.n(N),J=(t(9657),t(3339)),K=t.n(J),Q=t(2548),R=t.n(Q),X=(t(4973),t(4768)),Y=t(7758);const aa=H()(K(),R());var ea={components:{Select:Y.Z,Multiselect:M.Z,Editor:$.Z,Vue3TagsInput:L.Z,FilePond:aa},data(){return{page:{id:0,nombre:"",slug:"",extracto:"",contenido:"",status:1,subtitle:"",img:"",Tags:"",Options:[],publica:0,grupos:[],grupos_assign:[]},plugins:"code autoresize autosave link image",toolbar:"undo redo | fontsizeselect formatselect | bold italic forecolor | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent blockquote | link image media",language:"es",editor:null}},watch:{"page.nombre":function(a){this.page.slug=this.createSlug(a)}},mounted(){this.page.id="undefined"!==typeof this.$route.params.id?parseInt(this.$route.params.id):0,this.getGrupos()},methods:{addTag(a){this.page.Options=a,this.page.Tags=a.toString()},handleFileUpload(a,e,t,l,o,s,n,i){const r=new FormData;for(const u in i)"img"!==u&&r.append(u,i[u]);r.append(a,e,e.name);const d=0!==this.page.id?"paginas-promociones/new/edit/"+this.page.id:"paginas-promociones/new/edit";return X.Z.doAjax("FILE",d,r,(function(a){a.status?(null!==a.data.id&&(i.id=a.data.id),null!==a.data.nombre&&(i.nombre=a.data.nombre),null!==a.data.slug&&(i.slug=a.data.slug),null!==a.data.extracto&&(i.extracto=a.data.extracto),null!==a.data.contenido&&(i.contenido=a.data.contenido),null!==a.data.status&&(i.status=a.data.status),null!==a.data.img&&(i.img=a.data.img),null!==a.data.subtitle&&(i.subtitle=a.data.subtitle),null!==a.data.Tags&&"null"!==a.data.Tags&&(console.log(a.data.Tags),i.Tags=a.data.Tags,i.Options=i.Tags.split(",")),X.Z.alert(a.msg),l(a.msg)):X.Z.alert(a.msg)}),(function(a){X.Z.alert(a.msg)})),{abort:()=>{n()}}},getItem(){const a=this;X.Z.doAjax("GET","paginas-promociones/by/"+a.page.id,{},(function(e){null!==e.data.id&&(a.page.id=e.data.id),null!==e.data.nombre&&(a.page.nombre=e.data.nombre),null!==e.data.slug&&(a.page.slug=e.data.slug),null!==e.data.extracto&&(a.page.extracto=e.data.extracto),null!==e.data.contenido&&(a.page.contenido=e.data.contenido),null!==e.data.status&&(a.page.status=e.data.status),null!==e.data.img&&(a.page.img=e.data.img),null!==e.data.subtitle&&(a.page.subtitle=e.data.subtitle),null!==e.data.subtitle&&(a.page.publica=e.data.publica),null!==e.data.Tags&&"null"!==e.data.Tags&&(a.page.Tags=e.data.Tags,a.page.Options=a.page.Tags.split(",")),null!==e.data.acc&&"null"!==e.data.acc&&(a.page.grupos_assign=[],Object.keys(e.data.acc).map((function(t,l){a.page.grupos_assign.push(e.data.acc[t])}))),X.Z.alert(e.msg)}),(function(a){X.Z.alert(a.msg,"danger")}))},guardarBlog(){const a=this;0===a.page.id?X.Z.confirm("Esta pagina se publicará automáticamente en el apartado de promociones del sitio",(function(){X.Z.doAjax("POST","paginas-promociones/new/edit",a.page,(function(e){"undefined"!==typeof e.data.id&&a.$router.push("/admin/blog/editar/"+e.data.id),setTimeout((function(){location.reload()}),500),X.Z.alert(e.msg)}),(function(a){X.Z.alert(a.msg)}))})):X.Z.doAjax("PUT","paginas-promociones/editar/"+a.page.id,a.page,(function(a){X.Z.alert(a.msg)}),(function(a){X.Z.alert(a.msg)}))},createSlug(a){return a.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,"")},getGrupos(){const a=this;X.Z.doAjax("GET","users/grupo/list",{},(function(e){a.page.grupos=[],Object.keys(e.data).map((function(t,l){a.page.grupos.push({value:e.data[t].id,label:e.data[t].nombre})})),a.page.id>0&&a.getItem()}),(function(a){X.Z.alert(a.msg,"danger")}))}}},ta=t(89);const la=(0,ta.Z)(ea,[["render",W]]);var oa=la}}]);
//# sourceMappingURL=9606.238597ec.js.map